FROM mcr.microsoft.com/playwright:v1.41.0-focal

WORKDIR /app

# Copier les fichiers de configuration
COPY package*.json ./
COPY tsconfig.json ./
COPY playwright.config.ts ./
COPY .eslintrc.js ./

# Installer les dépendances
RUN npm ci

# Copier les tests et utilitaires
COPY specs/ ./specs/
COPY utils/ ./utils/
COPY global.setup.ts ./
COPY global.teardown.ts ./

# Installer les navigateurs Playwright
RUN npx playwright install

# Créer les répertoires de sortie
RUN mkdir -p test-results playwright-report

# Commande par défaut
CMD ["npm", "run", "test"]

'use client'

import { createContext, useContext, useState, ReactNode } from 'react'

interface LanguageContextType {
  currentLanguage: string
  setLanguage: (lang: string) => void
  t: (key: string) => string
}

const LanguageContext = createContext<LanguageContextType | undefined>(undefined)

// TRADUCTIONS MINIMALES MAIS COMPLÃˆTES
const translations: Record<string, Record<string, string>> = {
  fr: {
    'title': 'MathÃ©matiques pour Enfants',
    'subtitle': "L'app Ã©ducative #1 pour apprendre les mathÃ©matiques en famille",
    'families': 'Rejoignez plus de 100.000 familles qui apprennent dÃ©jÃ  !',
    'start_free': 'Commencer gratuitement',
    'compare_prices': 'Comparer les prix',
    'badge': 'App Ã©ducative #1',
    'plan_free': 'Gratuit',
    'plan_trial_14': 'Essai 14j',
    'plan_trial_7': 'Essai 7j',
    'plan_family': 'Plan Famille',
    'community_support': 'Support communautaire',
    'offline_limited': 'Mode hors-ligne limitÃ©',
    'unlimited_questions': 'Questions illimitÃ©es',
    'complete_levels': '5 niveaux complets',
    'trial_14d': '14j gratuit'
  },
  en: {
    'title': 'Math for Children',
    'subtitle': 'The #1 educational app to learn mathematics as a family',
    'families': 'Join over 100,000 families already learning!',
    'start_free': 'Start for free',
    'compare_prices': 'Compare prices',
    'badge': '#1 educational app',
    'plan_free': 'Free',
    'plan_trial_14': '14-day Trial',
    'plan_trial_7': '7-day Trial',
    'plan_family': 'Family Plan',
    'community_support': 'Community support',
    'offline_limited': 'Limited offline mode',
    'unlimited_questions': 'Unlimited questions',
    'complete_levels': '5 complete levels',
    'trial_14d': '14d free'
  },
  es: {
    'title': 'MatemÃ¡ticas para NiÃ±os',
    'subtitle': 'La app educativa #1 para aprender matemÃ¡ticas en familia',
    'families': 'Â¡Ãšnete a mÃ¡s de 100,000 familias que ya estÃ¡n aprendiendo!',
    'start_free': 'Comenzar gratis',
    'compare_prices': 'Comparar precios',
    'badge': 'App educativa #1',
    'plan_free': 'Gratis',
    'plan_trial_14': 'Prueba 14d',
    'plan_trial_7': 'Prueba 7d',
    'plan_family': 'Plan Familiar',
    'community_support': 'Soporte comunitario',
    'offline_limited': 'Modo sin conexiÃ³n limitado',
    'unlimited_questions': 'Preguntas ilimitadas',
    'complete_levels': '5 niveles completos',
    'trial_14d': '14d gratis'
  },
  zh: {
    'title': 'å„¿ç«¥æ•°å­¦',
    'subtitle': 'å®¶åº­å­¦ä¹ æ•°å­¦çš„#1æ•™è‚²åº”ç”¨',
    'families': 'åŠ å…¥å·²ç»åœ¨å­¦ä¹ çš„100,000+å®¶åº­ï¼',
    'start_free': 'å…è´¹å¼€å§‹',
    'compare_prices': 'æ¯”è¾ƒä»·æ ¼',
    'badge': 'æ³•å›½#1æ•™è‚²åº”ç”¨',
    'plan_free': 'å…è´¹',
    'plan_trial_14': '14å¤©è¯•ç”¨',
    'plan_trial_7': '7å¤©è¯•ç”¨',
    'plan_family': 'å®¶åº­è®¡åˆ’',
    'community_support': 'ç¤¾åŒºæ”¯æŒ',
    'offline_limited': 'æœ‰é™ç¦»çº¿æ¨¡å¼',
    'unlimited_questions': 'æ— é™é—®é¢˜',
    'complete_levels': '5ä¸ªå®Œæ•´çº§åˆ«',
    'trial_14d': '14å¤©å…è´¹'
  },
  ar: {
    'title': 'Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠØ§Øª Ù„Ù„Ø£Ø·ÙØ§Ù„',
    'subtitle': 'Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠ #1 Ù„ØªØ¹Ù„Ù… Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠØ§Øª ÙÙŠ Ø§Ù„Ø¹Ø§Ø¦Ù„Ø©',
    'families': 'Ø§Ù†Ø¶Ù… Ø¥Ù„Ù‰ Ø£ÙƒØ«Ø± Ù…Ù† 100,000 Ø¹Ø§Ø¦Ù„Ø© ØªØªØ¹Ù„Ù… Ø¨Ø§Ù„ÙØ¹Ù„!',
    'start_free': 'Ø§Ø¨Ø¯Ø£ Ù…Ø¬Ø§Ù†Ø§Ù‹',
    'compare_prices': 'Ù‚Ø§Ø±Ù† Ø§Ù„Ø£Ø³Ø¹Ø§Ø±',
    'badge': 'Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠ #1',
    'plan_free': 'Ù…Ø¬Ø§Ù†ÙŠ',
    'plan_trial_14': 'ØªØ¬Ø±Ø¨Ø© 14 ÙŠÙˆÙ…',
    'plan_trial_7': 'ØªØ¬Ø±Ø¨Ø© 7 Ø£ÙŠØ§Ù…',
    'plan_family': 'Ø®Ø·Ø© Ø§Ù„Ø¹Ø§Ø¦Ù„Ø©',
    'community_support': 'Ø¯Ø¹Ù… Ø§Ù„Ù…Ø¬ØªÙ…Ø¹',
    'offline_limited': 'ÙˆØ¶Ø¹ Ø¹Ø¯Ù… Ø§Ù„Ø§ØªØµØ§Ù„ Ù…Ø­Ø¯ÙˆØ¯',
    'unlimited_questions': 'Ø£Ø³Ø¦Ù„Ø© ØºÙŠØ± Ù…Ø­Ø¯ÙˆØ¯Ø©',
    'complete_levels': '5 Ù…Ø³ØªÙˆÙŠØ§Øª ÙƒØ§Ù…Ù„Ø©',
    'trial_14d': '14 ÙŠÙˆÙ… Ù…Ø¬Ø§Ù†ÙŠ'
  }
}

export function LanguageProvider({ children }: { children: ReactNode }) {
  const [currentLanguage, setCurrentLanguage] = useState('fr')

  const setLanguage = (lang: string) => {
    console.log('ðŸŒ CHANGEMENT DE LANGUE VERS:', lang)
    setCurrentLanguage(lang)
    localStorage.setItem('math4child-language', lang)
  }

  const t = (key: string): string => {
    const translation = translations[currentLanguage]?.[key] || translations['en']?.[key] || key
    console.log(`ðŸ”¤ Traduction ${currentLanguage}.${key} = "${translation}"`)
    return translation
  }

  return (
    <LanguageContext.Provider value={{ currentLanguage, setLanguage, t }}>
      {children}
    </LanguageContext.Provider>
  )
}

export function useLanguage() {
  const context = useContext(LanguageContext)
  if (!context) {
    throw new Error('useLanguage must be used within a LanguageProvider')
  }
  return context
}
